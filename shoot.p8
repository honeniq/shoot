pico-8 cartridge // http://www.pico-8.com
version 16
__lua__


function init_player()
  player={
    bullets={},
    x=64,
    y=100,
    shot=function(self)
      add(self.bullets, add_bullet())
    end
  }
  bullet_count=0
end

function add_bullet()
  local bullet={
    x=player.x,
    y=player.y,
    life=50
  }
  return bullet
end

function draw_bullets()
  foreach(player.bullets, function(b)
    spr(5, b.x, b.y)
  end)
end

function update_bullets()
  bullet_count=0
  foreach(player.bullets, function(b)
    b.y -= 3
    b.life -= 1
    bullet_count += 1
    if(b.life < 1) del(player.bullets, b)
  end)
end

function _init()
  init_player()
end

function _update()
  if(btn(0)) player.x-=2
  if(btn(1)) player.x+=2
  if(btn(2)) player.y-=2
  if(btn(3)) player.y+=2
  if(btn(4)) player.shot(player)

  update_bullets()
end

function _draw()
  cls()
  spr(1, player.x, player.y)
  draw_bullets()
  print(bullet_count)
end

__gfx__
00000000000650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000660000000000000000000000000000007c00000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700006656000000000000000000000000000007c00000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000006665000000000000000000000000000007c00000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000066656500000000000000000000000000007c00000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700066665600000000000000000000000000007c00000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000666556560000000000000000000000000007c00000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000665555650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000bb000000bb000aaaaaaaa0aaaaaa00888888008888880000000000000000000000000000000000000000000000000000000000000000000000000
0000000000bbbb0000bbbb00aa0aa0aaaa0aa0aa8008800880088008000000000000000000000000000000000000000000000000000000000000000000000000
000000000b0bb0b00b0bb0b00a0aa0a0aa0aa0aa8808808888088088000000000000000000000000000000000000000000000000000000000000000000000000
000000000b0bb0b00b0bb0b00aaaaaa00aaaaaa08888888888888888000000000000000000000000000000000000000000000000000000000000000000000000
000000000bbbbbb00bbbbbb000aaaa0000aaaa000888888008888880000000000000000000000000000000000000000000000000000000000000000000000000
0000000000bbbb0000bbbb000a0aa0a00a0aa0a00888888008888880000000000000000000000000000000000000000000000000000000000000000000000000
000000000b0bb0b00b0bb0b0000aa00000a00a000808080880808080000000000000000000000000000000000000000000000000000000000000000000000000
00000000b000000b0b0000b000a00a00aa0000aa0808080880808080000000000000000000000000000000000000000000000000000000000000000000000000
